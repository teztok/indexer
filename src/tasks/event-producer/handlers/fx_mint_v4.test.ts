import FxMintV4Handler from './fx_mint_v4';
import { transactionsToEvents } from '../event-producer';
import { Transactions } from '../../../types';

test('creates FX_MINT_V4 events', async () => {
  const transactions: Transactions = [
    {
      id: 491477618655232,
      level: 3240869,
      timestamp: '2023-03-19T23:29:59Z',
      block: 'BLSMgufo8ViNYuXMJfSLzZScvbfbdGPDkdWFacbe5LcjTQuh3mD',
      hash: 'opYJABcmSNqxfbJULtMRQogi1dsSYP7AfpTupJTyYkWU2zYeYwZ',
      counter: 22492634,
      sender: {
        alias: 'tamasantalart',
        address: 'tz1QXGY9z6RWC6Toy88ixFfsXFKwEN9q5khd',
      },
      target: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      amount: 2500000,
      parameter: {
        entrypoint: 'mint',
        value: {
          referrer: null,
          issuer_id: '26049',
          recipient: null,
          input_bytes: '',
          create_ticket: null,
          reserve_input: null,
        },
      },
      status: 'applied',
      hasInternals: true,
      initiator: null,
      storage: {
        fees: '50',
        admin: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        ledger: 411393,
        paused: false,
        big_map: 411397,
        metadata: 411394,
        addresses: 411389,
        lock_time: '3600',
        all_tokens: '26054',
        locked_eps: false,
        user_actions: 411396,
        codex_entries: 411390,
        reserve_methods: 411395,
        all_gentk_tokens: '1',
        pricing_contracts: {
          '0': {
            address: 'KT1V24J6FVuKPU3xy6gVF6wJ3zdRXBheQhaV',
            enabled: true,
          },
          '1': {
            address: 'KT1MFgHKorMWXeVL6qrpgjZmemirafppSg9q',
            enabled: true,
          },
        },
        codex_entries_count: '6',
        entrypoints_enabled: 411391,
        gentk_void_metadata: '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
        referrer_fees_share: '200',
        issuer_codex_updates: 411392,
      },
      diffs: [
        {
          bigmap: 411396,
          path: 'user_actions',
          action: 'add_key',
          content: {
            hash: 'expruJPza3UFCe8DQX1Uom8VNAWESz7C8QpexS31GLsvYQn2LV9yoz',
            key: 'tz1QXGY9z6RWC6Toy88ixFfsXFKwEN9q5khd',
            value: {
              last_minted: ['1'],
              last_minted_time: '2023-03-19T23:29:59Z',
              last_issuer_minted: '0',
              last_issuer_minted_time: '1970-01-01T00:00:00Z',
            },
          },
        },
        {
          bigmap: 411393,
          path: 'ledger',
          action: 'update_key',
          content: {
            hash: 'expruboqdV9vUndibdWLNFQQDDgnCRo5t9SVTWX6sgWaM974Z28Jtt',
            key: '26049',
            value: {
              tags: ['100'],
              author: 'tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks',
              supply: '70',
              balance: '69',
              enabled: true,
              codex_id: '1',
              metadata: '697066733a2f2f516d61696d7669686a436275647a4b776557746976765066526454535163794779695379697a726b7a5039776961',
              reserves: [],
              royalties: '120',
              pricing_id: '0',
              has_tickets: false,
              open_editions: null,
              primary_split: [
                {
                  pct: '1000',
                  address: 'tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks',
                },
              ],
              locked_seconds: '0',
              royalties_split: [
                {
                  pct: '1000',
                  address: 'tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks',
                },
              ],
              input_bytes_size: '0',
              iterations_count: '1',
              timestamp_minted: '2023-03-19T23:15:59Z',
              lock_price_for_reserves: false,
            },
          },
        },
      ],
      nonce: null,
    },
    {
      id: 491477621800960,
      level: 3240869,
      timestamp: '2023-03-19T23:29:59Z',
      block: 'BLSMgufo8ViNYuXMJfSLzZScvbfbdGPDkdWFacbe5LcjTQuh3mD',
      hash: 'opYJABcmSNqxfbJULtMRQogi1dsSYP7AfpTupJTyYkWU2zYeYwZ',
      counter: 22492634,
      sender: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      target: {
        address: 'KT1EfsNuqwLAWDd3o4pvfUx1CAh5GMdTrRvr',
      },
      amount: 0,
      parameter: {
        entrypoint: 'mint',
        value: {
          address: 'tz1QXGY9z6RWC6Toy88ixFfsXFKwEN9q5khd',
          metadata: {
            '': '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
          },
          token_id: '0',
          issuer_id: '26049',
          iteration: '1',
          royalties: '120',
          input_bytes: '',
          royalties_split: [
            {
              pct: '1000',
              address: 'tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks',
            },
          ],
        },
      },
      status: 'applied',
      hasInternals: false,
      initiator: {
        alias: 'tamasantalart',
        address: 'tz1QXGY9z6RWC6Toy88ixFfsXFKwEN9q5khd',
      },
      storage: {
        issuer: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
        ledger: 411398,
        paused: false,
        signer: 'tz1e8XGv6ngNoLt1ZNkEi6sG1A39yF48iwdS',
        metadata: 411399,
        operators: 411400,
        all_tokens: '1',
        token_data: 411401,
        administrator: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        token_metadata: 411402,
        treasury_address: 'tz1dtzgLYUHMhP6sWeFtFsHkHqyPezBBPLsZ',
      },
      diffs: [
        {
          bigmap: 411402,
          path: 'token_metadata',
          action: 'add_key',
          content: {
            hash: 'exprtZBwZUeYYYfUs9B9Rg2ywHezVHnCCnmF9WsDQVrs582dSK63dC',
            key: '0',
            value: {
              token_id: '0',
              token_info: {
                '': '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
              },
            },
          },
        },
        {
          bigmap: 411401,
          path: 'token_data',
          action: 'add_key',
          content: {
            hash: 'exprtZBwZUeYYYfUs9B9Rg2ywHezVHnCCnmF9WsDQVrs582dSK63dC',
            key: '0',
            value: {
              minter: 'tz1QXGY9z6RWC6Toy88ixFfsXFKwEN9q5khd',
              assigned: false,
              issuer_id: '26049',
              iteration: '1',
              royalties: '120',
              input_bytes: '',
              royalties_split: [
                {
                  pct: '1000',
                  address: 'tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks',
                },
              ],
            },
          },
        },
        {
          bigmap: 411398,
          path: 'ledger',
          action: 'add_key',
          content: {
            hash: 'exprvTb42ZYSAPremhqPim6Rf4BM9s6iggtWBKG4t3qjUrQe4E2RzM',
            key: {
              nat: '0',
              address: 'tz1QXGY9z6RWC6Toy88ixFfsXFKwEN9q5khd',
            },
            value: '1',
          },
        },
      ],
      nonce: 18,
    },
    {
      id: 492558407958528,
      level: 3244497,
      timestamp: '2023-03-21T05:50:14Z',
      block: 'BMLfKhMk6YG4yjND2vwAeYNUm3VrFztCcqEhym2EFpsGuoi3Lvi',
      hash: 'oo6t3rVWawXzYExcZf9Fvri33k37UNTkXCuxmZtU3tfFPHFL51r',
      counter: 32395181,
      sender: {
        address: 'KT1Ryab5JZ4JrUJeHg1mFxZ86E4nYMyPb3NA',
      },
      target: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      amount: 0,
      parameter: {
        entrypoint: 'mint',
        value: {
          referrer: null,
          issuer_id: '26109',
          recipient: 'tz1eeATpjgjcoVcAL9dpjUed94tzmnHyiDHT',
          input_bytes: '4044800000000000',
          create_ticket: null,
          reserve_input: '05070703060000',
        },
      },
      status: 'applied',
      hasInternals: false,
      initiator: {
        alias: 'cryptoartmagazine',
        address: 'tz1eeATpjgjcoVcAL9dpjUed94tzmnHyiDHT',
      },
      storage: {
        fees: '50',
        admin: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        ledger: 411393,
        paused: false,
        big_map: 411397,
        metadata: 411394,
        addresses: 411389,
        lock_time: '3600',
        all_tokens: '26120',
        locked_eps: false,
        user_actions: 411396,
        codex_entries: 411390,
        reserve_methods: 411395,
        all_gentk_tokens: '1566',
        pricing_contracts: {
          '0': {
            address: 'KT1V24J6FVuKPU3xy6gVF6wJ3zdRXBheQhaV',
            enabled: true,
          },
          '1': {
            address: 'KT1MFgHKorMWXeVL6qrpgjZmemirafppSg9q',
            enabled: true,
          },
        },
        codex_entries_count: '72',
        entrypoints_enabled: 411391,
        gentk_void_metadata: '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
        referrer_fees_share: '200',
        issuer_codex_updates: 411392,
      },
      diffs: [
        {
          bigmap: 411396,
          path: 'user_actions',
          action: 'update_key',
          content: {
            hash: 'exprv1wZFrAyvPyAzeu8FNS9zhhxZmTZ5mS1AK6hFKExA7LWqVsbDZ',
            key: 'KT1Ryab5JZ4JrUJeHg1mFxZ86E4nYMyPb3NA',
            value: {
              last_minted: ['1566'],
              last_minted_time: '2023-03-21T05:50:14Z',
              last_issuer_minted: '0',
              last_issuer_minted_time: '1970-01-01T00:00:00Z',
            },
          },
        },
        {
          bigmap: 411393,
          path: 'ledger',
          action: 'update_key',
          content: {
            hash: 'exprtadWsJfKBE3JSmMet84uVUU5hVzz5boNu8wmnEtP68up3QJxFy',
            key: '26109',
            value: {
              tags: ['101'],
              author: 'tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD',
              supply: '1000',
              balance: '987',
              enabled: true,
              codex_id: '61',
              metadata: '697066733a2f2f516d5a465a48695447703152574e66315455715a68444a764135536275787932424d5a4c4b53616b6d597a706379',
              reserves: [
                {
                  data: '05020000002007040a0000001601beca8abda0585816a8ce56c384f596a57ce4b80000009b0f',
                  amount: '987',
                  method_id: '0',
                },
              ],
              royalties: '100',
              pricing_id: '0',
              has_tickets: true,
              open_editions: null,
              primary_split: [
                {
                  pct: '1000',
                  address: 'tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD',
                },
              ],
              locked_seconds: '0',
              royalties_split: [
                {
                  pct: '1000',
                  address: 'tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD',
                },
              ],
              input_bytes_size: '8',
              iterations_count: '13',
              timestamp_minted: '2023-03-20T22:19:44Z',
              lock_price_for_reserves: false,
            },
          },
        },
      ],
      nonce: 5,
    },
    {
      id: 492558409007104,
      level: 3244497,
      timestamp: '2023-03-21T05:50:14Z',
      block: 'BMLfKhMk6YG4yjND2vwAeYNUm3VrFztCcqEhym2EFpsGuoi3Lvi',
      hash: 'oo6t3rVWawXzYExcZf9Fvri33k37UNTkXCuxmZtU3tfFPHFL51r',
      counter: 32395181,
      sender: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      target: {
        address: 'KT1EfsNuqwLAWDd3o4pvfUx1CAh5GMdTrRvr',
      },
      amount: 0,
      parameter: {
        entrypoint: 'mint',
        value: {
          address: 'tz1eeATpjgjcoVcAL9dpjUed94tzmnHyiDHT',
          metadata: {
            '': '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
          },
          token_id: '1565',
          issuer_id: '26109',
          iteration: '13',
          royalties: '100',
          input_bytes: '4044800000000000',
          royalties_split: [
            {
              pct: '1000',
              address: 'tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD',
            },
          ],
        },
      },
      status: 'applied',
      hasInternals: false,
      initiator: {
        alias: 'cryptoartmagazine',
        address: 'tz1eeATpjgjcoVcAL9dpjUed94tzmnHyiDHT',
      },
      storage: {
        issuer: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
        ledger: 411398,
        paused: false,
        signer: 'tz1e8XGv6ngNoLt1ZNkEi6sG1A39yF48iwdS',
        metadata: 411399,
        operators: 411400,
        all_tokens: '1566',
        token_data: 411401,
        administrator: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        token_metadata: 411402,
        treasury_address: 'tz1dtzgLYUHMhP6sWeFtFsHkHqyPezBBPLsZ',
      },
      diffs: [
        {
          bigmap: 411402,
          path: 'token_metadata',
          action: 'add_key',
          content: {
            hash: 'expru7xHkyBbKwRjNNc8RUsbVC8tVUvCwRAFyWfSmRZafjVp1kq2G4',
            key: '1565',
            value: {
              token_id: '1565',
              token_info: {
                '': '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
              },
            },
          },
        },
        {
          bigmap: 411401,
          path: 'token_data',
          action: 'add_key',
          content: {
            hash: 'expru7xHkyBbKwRjNNc8RUsbVC8tVUvCwRAFyWfSmRZafjVp1kq2G4',
            key: '1565',
            value: {
              minter: 'tz1eeATpjgjcoVcAL9dpjUed94tzmnHyiDHT',
              assigned: false,
              issuer_id: '26109',
              iteration: '13',
              royalties: '100',
              input_bytes: '4044800000000000',
              royalties_split: [
                {
                  pct: '1000',
                  address: 'tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD',
                },
              ],
            },
          },
        },
        {
          bigmap: 411398,
          path: 'ledger',
          action: 'add_key',
          content: {
            hash: 'exprupY4B4Zynh1dAD9gC4XNfef27wT1RTP2WQFLeir9vCsesGEiko',
            key: {
              nat: '1565',
              address: 'tz1eeATpjgjcoVcAL9dpjUed94tzmnHyiDHT',
            },
            value: '1',
          },
        },
      ],
      nonce: 6,
    },
    {
      id: 512170946199552,
      level: 3316990,
      timestamp: '2023-04-07T05:31:37Z',
      block: 'BMGd7UzPuJcLYg96nQEjoCJVSHYCDP7ZivULPbSe1MuZYw9sDmD',
      hash: 'opRA2cUJDsGvYqNV9TM59Ruu4ZybP5rjbq9RBFgQYuw5EgEAJFo',
      counter: 43382793,
      sender: {
        address: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
      },
      target: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      amount: 2000000,
      parameter: {
        entrypoint: 'mint',
        value: {
          referrer: null,
          issuer_id: '26485',
          recipient: null,
          input_bytes: '',
          create_ticket: null,
          reserve_input: null,
        },
      },
      status: 'applied',
      hasInternals: true,
      initiator: null,
      storage: {
        fees: '50',
        admin: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        ledger: 411393,
        paused: false,
        big_map: 411397,
        metadata: 411394,
        addresses: 411389,
        lock_time: '3600',
        all_tokens: '26501',
        locked_eps: false,
        user_actions: 411396,
        codex_entries: 411390,
        reserve_methods: 411395,
        all_gentk_tokens: '14649',
        pricing_contracts: {
          '0': {
            address: 'KT1V24J6FVuKPU3xy6gVF6wJ3zdRXBheQhaV',
            enabled: true,
          },
          '1': {
            address: 'KT1MFgHKorMWXeVL6qrpgjZmemirafppSg9q',
            enabled: true,
          },
        },
        codex_entries_count: '453',
        entrypoints_enabled: 411391,
        gentk_void_metadata: '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
        referrer_fees_share: '200',
        issuer_codex_updates: 411392,
      },
      diffs: [
        {
          bigmap: 411396,
          path: 'user_actions',
          action: 'update_key',
          content: {
            hash: 'expru2iukTarPvptEcahjwCQG9XZ6LymFNJjb4fSKSf1kfCeJ1fhb4',
            key: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
            value: {
              last_minted: ['14649'],
              last_minted_time: '2023-04-07T05:31:37Z',
              last_issuer_minted: '0',
              last_issuer_minted_time: '1970-01-01T00:00:00Z',
            },
          },
        },
        {
          bigmap: 411393,
          path: 'ledger',
          action: 'update_key',
          content: {
            hash: 'expruhU6Yvx1oeV46yW9FGmdVuXrVVDDCxuVfYgm5KF7uDmYEtFiQ3',
            key: '26485',
            value: {
              tags: [],
              author: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
              supply: '64',
              balance: '51',
              enabled: true,
              codex_id: '437',
              metadata: '697066733a2f2f516d506d546f383378375864416553597a4642653655657647356561456256537936487a6e5241326a7779574162',
              reserves: [
                {
                  data: '05020000001f07040a00000016000082190361da2b156bb56eeaf7ffae3e4ff6fd34b90000',
                  amount: '0',
                  method_id: '0',
                },
              ],
              royalties: '150',
              pricing_id: '0',
              has_tickets: false,
              open_editions: null,
              primary_split: [
                {
                  pct: '1000',
                  address: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
                },
              ],
              locked_seconds: '0',
              royalties_split: [
                {
                  pct: '1000',
                  address: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
                },
              ],
              input_bytes_size: '0',
              iterations_count: '13',
              timestamp_minted: '2023-04-06T06:55:08Z',
              lock_price_for_reserves: false,
            },
          },
        },
      ],
      nonce: null,
    },
    {
      id: 512170947248128,
      level: 3316990,
      timestamp: '2023-04-07T05:31:37Z',
      block: 'BMGd7UzPuJcLYg96nQEjoCJVSHYCDP7ZivULPbSe1MuZYw9sDmD',
      hash: 'opRA2cUJDsGvYqNV9TM59Ruu4ZybP5rjbq9RBFgQYuw5EgEAJFo',
      counter: 43382793,
      sender: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      target: {
        alias: 'FXHASH treasury',
        address: 'tz1dtzgLYUHMhP6sWeFtFsHkHqyPezBBPLsZ',
      },
      amount: 100000,
      parameter: null,
      status: 'applied',
      hasInternals: false,
      initiator: {
        address: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
      },
      storage: null,
      diffs: null,
      nonce: 1,
    },
    {
      id: 512170948296704,
      level: 3316990,
      timestamp: '2023-04-07T05:31:37Z',
      block: 'BMGd7UzPuJcLYg96nQEjoCJVSHYCDP7ZivULPbSe1MuZYw9sDmD',
      hash: 'opRA2cUJDsGvYqNV9TM59Ruu4ZybP5rjbq9RBFgQYuw5EgEAJFo',
      counter: 43382793,
      sender: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      target: {
        alias: 'planckC_',
        address: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
      },
      amount: 1900000,
      parameter: null,
      status: 'applied',
      hasInternals: false,
      initiator: {
        address: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
      },
      storage: null,
      diffs: null,
      nonce: 2,
    },
    {
      id: 512170949345280,
      level: 3316990,
      timestamp: '2023-04-07T05:31:37Z',
      block: 'BMGd7UzPuJcLYg96nQEjoCJVSHYCDP7ZivULPbSe1MuZYw9sDmD',
      hash: 'opRA2cUJDsGvYqNV9TM59Ruu4ZybP5rjbq9RBFgQYuw5EgEAJFo',
      counter: 43382793,
      sender: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      target: {
        address: 'KT1EfsNuqwLAWDd3o4pvfUx1CAh5GMdTrRvr',
      },
      amount: 0,
      parameter: {
        entrypoint: 'mint',
        value: {
          address: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
          metadata: {
            '': '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
          },
          token_id: '14648',
          issuer_id: '26485',
          iteration: '13',
          royalties: '150',
          input_bytes: '',
          royalties_split: [
            {
              pct: '1000',
              address: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
            },
          ],
        },
      },
      status: 'applied',
      hasInternals: false,
      initiator: {
        address: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
      },
      storage: {
        issuer: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
        ledger: 411398,
        paused: false,
        signer: 'tz1e8XGv6ngNoLt1ZNkEi6sG1A39yF48iwdS',
        metadata: 411399,
        operators: 411400,
        all_tokens: '14649',
        token_data: 411401,
        administrator: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        token_metadata: 411402,
        treasury_address: 'tz1dtzgLYUHMhP6sWeFtFsHkHqyPezBBPLsZ',
      },
      diffs: [
        {
          bigmap: 411402,
          path: 'token_metadata',
          action: 'add_key',
          content: {
            hash: 'expru6fAfnP2MgGkdbqSDVjtqpuDwzUwLC5jAWWhtBrpDtkDXQaDRc',
            key: '14648',
            value: {
              token_id: '14648',
              token_info: {
                '': '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
              },
            },
          },
        },
        {
          bigmap: 411401,
          path: 'token_data',
          action: 'add_key',
          content: {
            hash: 'expru6fAfnP2MgGkdbqSDVjtqpuDwzUwLC5jAWWhtBrpDtkDXQaDRc',
            key: '14648',
            value: {
              minter: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
              assigned: false,
              issuer_id: '26485',
              iteration: '13',
              royalties: '150',
              input_bytes: '',
              royalties_split: [
                {
                  pct: '1000',
                  address: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
                },
              ],
            },
          },
        },
        {
          bigmap: 411398,
          path: 'ledger',
          action: 'add_key',
          content: {
            hash: 'exprv4BHM5txZoQV1JrTB5puH74VeYVgbwKcEQe8ALwq5kgY17BeHb',
            key: {
              nat: '14648',
              address: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
            },
            value: '1',
          },
        },
      ],
      nonce: 3,
    },
    {
      id: 512414439178240,
      level: 3317935,
      timestamp: '2023-04-07T09:31:42Z',
      block: 'BLETyegKTdrDad9YRknLfFhkphGxA2KhH7ee5pLC8icnD8FzWLH',
      hash: 'oofjLzFcHXRkqchmgdUGwkpyYfTpfm1rF7nD3fjoLqVBDgCUutE',
      counter: 71776693,
      sender: {
        address: 'tz1VnNAKxCcK2W8MLPUPWqK24CUCwaANVZwV',
      },
      target: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      amount: 0,
      parameter: {
        entrypoint: 'mint',
        value: {
          referrer: null,
          issuer_id: '26499',
          recipient: null,
          input_bytes: '',
          create_ticket: '',
          reserve_input: null,
        },
      },
      status: 'applied',
      hasInternals: true,
      initiator: null,
      storage: {
        fees: '50',
        admin: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        ledger: 411393,
        paused: false,
        big_map: 411397,
        metadata: 411394,
        addresses: 411389,
        lock_time: '3600',
        all_tokens: '26503',
        locked_eps: false,
        user_actions: 411396,
        codex_entries: 411390,
        reserve_methods: 411395,
        all_gentk_tokens: '14734',
        pricing_contracts: {
          '0': {
            address: 'KT1V24J6FVuKPU3xy6gVF6wJ3zdRXBheQhaV',
            enabled: true,
          },
          '1': {
            address: 'KT1MFgHKorMWXeVL6qrpgjZmemirafppSg9q',
            enabled: true,
          },
        },
        codex_entries_count: '455',
        entrypoints_enabled: 411391,
        gentk_void_metadata: '697066733a2f2f516d5a5a56424b617044673277587a77704478646d4c39416836363568395a7a654a3967596462545a3447427a66',
        referrer_fees_share: '200',
        issuer_codex_updates: 411392,
      },
      diffs: [
        {
          bigmap: 411396,
          path: 'user_actions',
          action: 'update_key',
          content: {
            hash: 'expru436aWmFZMUkG4QD3LdFtLbbFHWg1NywCUz6PGgJFVrX8c837Y',
            key: 'tz1VnNAKxCcK2W8MLPUPWqK24CUCwaANVZwV',
            value: {
              last_minted: ['14734'],
              last_minted_time: '2023-04-07T09:31:42Z',
              last_issuer_minted: '0',
              last_issuer_minted_time: '1970-01-01T00:00:00Z',
            },
          },
        },
        {
          bigmap: 411393,
          path: 'ledger',
          action: 'update_key',
          content: {
            hash: 'expruLmTWh32UU8evayaaeoDwGpm1FyhTtN6E15V4BE8RZ6Z2BSQNJ',
            key: '26499',
            value: {
              tags: [],
              author: 'tz1foswFmZBNUFDkLTL6TxTruedN6gNZZdMQ',
              supply: '64',
              balance: '27',
              enabled: true,
              codex_id: '451',
              metadata: '697066733a2f2f516d5854656f5170784d674639684372434b787a614d347742547877717a3456355150726a325274316545417769',
              reserves: [],
              royalties: '170',
              pricing_id: '0',
              has_tickets: true,
              open_editions: null,
              primary_split: [
                {
                  pct: '1000',
                  address: 'tz1foswFmZBNUFDkLTL6TxTruedN6gNZZdMQ',
                },
              ],
              locked_seconds: '3600',
              royalties_split: [
                {
                  pct: '1000',
                  address: 'tz1foswFmZBNUFDkLTL6TxTruedN6gNZZdMQ',
                },
              ],
              input_bytes_size: '63',
              iterations_count: '16',
              timestamp_minted: '2023-04-07T03:32:14Z',
              lock_price_for_reserves: false,
            },
          },
        },
      ],
      nonce: null,
    },
    {
      id: 512414440226816,
      level: 3317935,
      timestamp: '2023-04-07T09:31:42Z',
      block: 'BLETyegKTdrDad9YRknLfFhkphGxA2KhH7ee5pLC8icnD8FzWLH',
      hash: 'oofjLzFcHXRkqchmgdUGwkpyYfTpfm1rF7nD3fjoLqVBDgCUutE',
      counter: 71776693,
      sender: {
        address: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
      },
      target: {
        address: 'KT19etLCjCCzTLFFAxsxLFsVYMRPetr2bTD5',
      },
      amount: 0,
      parameter: {
        entrypoint: 'mint',
        value: {
          price: '0',
          minter: 'tz1VnNAKxCcK2W8MLPUPWqK24CUCwaANVZwV',
          project_id: '26499',
        },
      },
      status: 'applied',
      hasInternals: false,
      initiator: {
        address: 'tz1VnNAKxCcK2W8MLPUPWqK24CUCwaANVZwV',
      },
      storage: {
        fees: '0',
        issuer: 'KT1Xpmp15KfqoePNW9HczFmqaGNHwadV2a3b',
        ledger: 411409,
        big_map: 411414,
        metadata: 411410,
        min_price: '100000',
        locked_eps: false,
        token_data: 411412,
        project_data: 411411,
        administrator: 'tz1fepn7jZsCYBqCDhpM63hzh9g2Ytqk4Tpv',
        last_token_id: '5089',
        token_metadata: 411413,
        available_balance: '0',
      },
      diffs: [
        {
          bigmap: 411413,
          path: 'token_metadata',
          action: 'add_key',
          content: {
            hash: 'expruKHqrHECdv6qDzifBpccJ6JMB2yV4zWLMJtZzouzt8utXwtUnh',
            key: '5088',
            value: {
              token_id: '5088',
              token_info: {
                '': '697066733a2f2f516d524b517257796831396e6a6935394a3566726b36704558476469614c456b59346461524d3941597546503831',
              },
            },
          },
        },
        {
          bigmap: 411412,
          path: 'token_data',
          action: 'add_key',
          content: {
            hash: 'expruKHqrHECdv6qDzifBpccJ6JMB2yV4zWLMJtZzouzt8utXwtUnh',
            key: '5088',
            value: {
              price: '100000',
              minter: 'tz1VnNAKxCcK2W8MLPUPWqK24CUCwaANVZwV',
              created_at: '2023-04-07T09:31:42Z',
              project_id: '26499',
              taxation_start: '2023-04-14T09:31:42Z',
              taxation_locked: '0',
            },
          },
        },
        {
          bigmap: 411409,
          path: 'ledger',
          action: 'add_key',
          content: {
            hash: 'expruKHqrHECdv6qDzifBpccJ6JMB2yV4zWLMJtZzouzt8utXwtUnh',
            key: '5088',
            value: 'tz1VnNAKxCcK2W8MLPUPWqK24CUCwaANVZwV',
          },
        },
      ],
      nonce: 3,
    },
  ];

  const events = transactionsToEvents(transactions, [FxMintV4Handler]);

  expect(events).toStrictEqual([
    {
      id: 'dcaacc3302b4552b4dc7eebf3554144a',
      type: 'FX_MINT_V4',
      implements: 'SALE',
      opid: '491477618655232',
      ophash: 'opYJABcmSNqxfbJULtMRQogi1dsSYP7AfpTupJTyYkWU2zYeYwZ',
      timestamp: '2023-03-19T23:29:59Z',
      level: 3240869,
      fa2_address: 'KT1EfsNuqwLAWDd3o4pvfUx1CAh5GMdTrRvr',
      token_id: '0',
      editions: '1',
      seller_address: 'tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks',
      artist_address: 'tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks',
      buyer_address: 'tz1QXGY9z6RWC6Toy88ixFfsXFKwEN9q5khd',
      is_verified_artist: false,
      issuer_id: '26049',
      iteration: '1',
      royalties: '120',
      price: '2500000',
      metadata_uri: 'ipfs://QmZZVBKapDg2wXzwpDxdmL9Ah665h9ZzeJ9gYdbTZ4GBzf',
      royalty_shares: {
        decimals: 6,
        shares: {
          tz2JyW132finpXHFNCSrHtcBEHRmwp5ffYks: '120000',
        },
      },
    },
    {
      artist_address: 'tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD',
      buyer_address: 'tz1eeATpjgjcoVcAL9dpjUed94tzmnHyiDHT',
      editions: '1',
      fa2_address: 'KT1EfsNuqwLAWDd3o4pvfUx1CAh5GMdTrRvr',
      id: '7392fee002b650443331d7400ae7c7d0',
      implements: 'SALE',
      is_verified_artist: false,
      issuer_id: '26109',
      iteration: '13',
      level: 3244497,
      metadata_uri: 'ipfs://QmZZVBKapDg2wXzwpDxdmL9Ah665h9ZzeJ9gYdbTZ4GBzf',
      ophash: 'oo6t3rVWawXzYExcZf9Fvri33k37UNTkXCuxmZtU3tfFPHFL51r',
      opid: '492558407958528',
      price: '0',
      royalties: '100',
      royalty_shares: {
        decimals: 6,
        shares: {
          tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD: '100000',
        },
      },
      seller_address: 'tz1RkYY3jr1ocuPdQqrRefr5FqoawKQsmBmD',
      timestamp: '2023-03-21T05:50:14Z',
      token_id: '1565',
      type: 'FX_MINT_V4',
    },
    {
      artist_address: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
      buyer_address: 'tz1bhbx2P33zfCL7DLMEDHxT4rtjQZtqsrXN',
      editions: '1',
      fa2_address: 'KT1EfsNuqwLAWDd3o4pvfUx1CAh5GMdTrRvr',
      id: 'ff8443e5645412aec8948089a5422403',
      implements: 'SALE',
      is_verified_artist: false,
      issuer_id: '26485',
      iteration: '13',
      level: 3316990,
      metadata_uri: 'ipfs://QmZZVBKapDg2wXzwpDxdmL9Ah665h9ZzeJ9gYdbTZ4GBzf',
      ophash: 'opRA2cUJDsGvYqNV9TM59Ruu4ZybP5rjbq9RBFgQYuw5EgEAJFo',
      opid: '512170946199552',
      price: '2000000',
      royalties: '150',
      royalty_shares: {
        decimals: 6,
        shares: {
          tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo: '150000',
        },
      },
      seller_address: 'tz1XVvW1H1WvHDq52GZwgav5DhtDSsGT8UDo',
      timestamp: '2023-04-07T05:31:37Z',
      token_id: '14648',
      type: 'FX_MINT_V4',
    },
    {
      artist_address: 'tz1foswFmZBNUFDkLTL6TxTruedN6gNZZdMQ',
      buyer_address: 'tz1VnNAKxCcK2W8MLPUPWqK24CUCwaANVZwV',
      editions: '1',
      fa2_address: 'KT19etLCjCCzTLFFAxsxLFsVYMRPetr2bTD5',
      id: 'd40b2dbf15cd7a7ca1e5cefdccf4f808',
      implements: 'SALE',
      is_verified_artist: false,
      issuer_id: '26499',
      level: 3317935,
      metadata_uri: 'ipfs://QmRKQrWyh19nji59J5frk6pEXGdiaLEkY4daRM9AYuFP81',
      ophash: 'oofjLzFcHXRkqchmgdUGwkpyYfTpfm1rF7nD3fjoLqVBDgCUutE',
      opid: '512414439178240',
      price: '0',
      royalties: '170',
      royalty_shares: {
        decimals: 6,
        shares: {
          tz1foswFmZBNUFDkLTL6TxTruedN6gNZZdMQ: '170000',
        },
      },
      seller_address: 'tz1foswFmZBNUFDkLTL6TxTruedN6gNZZdMQ',
      timestamp: '2023-04-07T09:31:42Z',
      token_id: '5088',
      type: 'FX_MINT_V4',
    },
  ]);
});
